@tool
#class_name
extends VBoxContainer

# docstring


#################################################
#___________________ SIGNALS ___________________#
#################################################




#################################################
#____________________ ENUMS ____________________#
#################################################




#################################################
#__________________ CONSTANTS __________________#
#################################################



#################################################
#______________ EXPORTED VARIABLES _____________#
#################################################



#################################################
#_______________ PUBLIC VARIABLES ______________#
#################################################

var root: TreeItem


#################################################
#_______________ PRIVATE VARIABLES _____________#
#################################################




#################################################
#______________ ONREADY VARIABLES ______________#
#################################################

@onready var name_label: Label = $Name
@onready var tree: Tree = $Tree



#################################################
#___________________ _init() ___________________#
#################################################


#################################################
#________________ _enter_tree() ________________#
#################################################


#################################################
#___________________ _ready() __________________#
#################################################

func _ready() -> void:
	root = tree.create_item()
	tree.hide_root = true
	return


#################################################
#_______________ VIRTUAL METHODS _______________#
#################################################




#################################################
#________________ PUBLIC METHODS _______________#
#################################################

func display(res: SectionResource) -> void:
	name_label.text = res.name
	
	var items: Array[ItemResource] = res.items # For auto-completion
	for item in items:
		var tree_item := tree.create_item(root)
		tree_item.set_text(0, item.name)
		tree_item.set_metadata(0, item)
	
	_update_Tree_minimum_size()
	return


#################################################
#________________ PRIVATE METHODS ______________#
#################################################

func _update_Tree_minimum_size() -> void:
	var item_area_rect := tree.get_item_area_rect(
		root.get_first_child()
	)
	
#	print(root.get_first_child().get_text(0))
#	print(root.get_child_count())
#	print(tree.get_theme_constant("v_seperation"))
	
	var new_custom_height: float = 0
	new_custom_height += item_area_rect.size.y
	new_custom_height += 4.0
	new_custom_height *= root.get_child_count()
	
	tree.set_custom_minimum_size(Vector2(
		0,
		new_custom_height
	))
	return


#################################################
#_______________ SIGNAL CALLBACKS ______________#
#################################################

#_______________________________________________#
#__________________ INTERNAL ___________________#
#_______________________________________________#



#_______________________________________________#
#__________________ EXTERNAL ___________________#
#_______________________________________________#



